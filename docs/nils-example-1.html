<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 7 NILS example 1 |     A general workflow for analysis of primary biodiversity data</title>
  <meta name="description" content="  A general workflow for analysis of primary biodiversity data" />
  <meta name="generator" content="bookdown 0.34 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 7 NILS example 1 |     A general workflow for analysis of primary biodiversity data" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="https://biodiversitydata-se.github.io/biodiversity-analysis-tools/images/sbdi-logo-orginal-large.png" />
  
  <meta name="github-repo" content="biodiversitydata-se/biodiversity-analysis-tools" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 7 NILS example 1 |     A general workflow for analysis of primary biodiversity data" />
  
  
  <meta name="twitter:image" content="https://biodiversitydata-se.github.io/biodiversity-analysis-tools/images/sbdi-logo-orginal-large.png" />

<meta name="author" content="Debora Arlt, Alejandro Ruete and Charles Campbell  for the Swedish Biodiversity Data Infrastructure" />


<meta name="date" content="2023-07-06" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="images/favicon_io/favicon.ico" type="image/x-icon" />
<link rel="prev" href="essential-biodiversity-variables.html"/>
<link rel="next" href="nils-example-2.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #204a87; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #204a87; font-weight: bold; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #ce5c00; font-weight: bold; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Biodiversity analysis tools</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="the-importance-of-questions-and-sources-of-data.html"><a href="the-importance-of-questions-and-sources-of-data.html"><i class="fa fa-check"></i><b>2</b> The importance of questions and sources of data</a>
<ul>
<li class="chapter" data-level="2.1" data-path="the-importance-of-questions-and-sources-of-data.html"><a href="the-importance-of-questions-and-sources-of-data.html#questions"><i class="fa fa-check"></i><b>2.1</b> Questions</a></li>
<li class="chapter" data-level="2.2" data-path="the-importance-of-questions-and-sources-of-data.html"><a href="the-importance-of-questions-and-sources-of-data.html#taxonomies"><i class="fa fa-check"></i><b>2.2</b> Taxonomies</a></li>
<li class="chapter" data-level="2.3" data-path="the-importance-of-questions-and-sources-of-data.html"><a href="the-importance-of-questions-and-sources-of-data.html#data-sources"><i class="fa fa-check"></i><b>2.3</b> Data Sources</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="the-importance-of-questions-and-sources-of-data.html"><a href="the-importance-of-questions-and-sources-of-data.html#biodiversity-record-data"><i class="fa fa-check"></i><b>2.3.1</b> Biodiversity record data</a></li>
<li class="chapter" data-level="2.3.2" data-path="the-importance-of-questions-and-sources-of-data.html"><a href="the-importance-of-questions-and-sources-of-data.html#taxonomic-diversity"><i class="fa fa-check"></i><b>2.3.2</b> Taxonomic diversity</a></li>
<li class="chapter" data-level="2.3.3" data-path="the-importance-of-questions-and-sources-of-data.html"><a href="the-importance-of-questions-and-sources-of-data.html#functional-diversity"><i class="fa fa-check"></i><b>2.3.3</b> Functional diversity</a></li>
<li class="chapter" data-level="2.3.4" data-path="the-importance-of-questions-and-sources-of-data.html"><a href="the-importance-of-questions-and-sources-of-data.html#genetic-data-bases"><i class="fa fa-check"></i><b>2.3.4</b> Genetic data bases</a></li>
<li class="chapter" data-level="2.3.5" data-path="the-importance-of-questions-and-sources-of-data.html"><a href="the-importance-of-questions-and-sources-of-data.html#environemntal-data"><i class="fa fa-check"></i><b>2.3.5</b> Environemntal data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-cleaning.html"><a href="data-cleaning.html"><i class="fa fa-check"></i><b>3</b> Data cleaning</a>
<ul>
<li class="chapter" data-level="3.1" data-path="data-cleaning.html"><a href="data-cleaning.html#resources"><i class="fa fa-check"></i><b>3.1</b> Resources</a></li>
<li class="chapter" data-level="3.2" data-path="data-cleaning.html"><a href="data-cleaning.html#taxonomies-1"><i class="fa fa-check"></i><b>3.2</b> Taxonomies</a></li>
<li class="chapter" data-level="3.3" data-path="data-cleaning.html"><a href="data-cleaning.html#location-data"><i class="fa fa-check"></i><b>3.3</b> Location data</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="data-cleaning.html"><a href="data-cleaning.html#locality-information"><i class="fa fa-check"></i><b>3.3.1</b> Locality information</a></li>
<li class="chapter" data-level="3.3.2" data-path="data-cleaning.html"><a href="data-cleaning.html#coordinate-uncertainty"><i class="fa fa-check"></i><b>3.3.2</b> Coordinate uncertainty</a></li>
<li class="chapter" data-level="3.3.3" data-path="data-cleaning.html"><a href="data-cleaning.html#coordinate-errors"><i class="fa fa-check"></i><b>3.3.3</b> Coordinate errors</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="data-cleaning.html"><a href="data-cleaning.html#examples"><i class="fa fa-check"></i><b>3.4</b> Examples</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="data-cleaning.html"><a href="data-cleaning.html#data-cleaning-cyperaceae-in-sweden"><i class="fa fa-check"></i><b>3.4.1</b> Data cleaning Cyperaceae in Sweden</a></li>
<li class="chapter" data-level="3.4.2" data-path="data-cleaning.html"><a href="data-cleaning.html#taxonomy"><i class="fa fa-check"></i><b>3.4.2</b> Taxonomy</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="fitness-for-use.html"><a href="fitness-for-use.html"><i class="fa fa-check"></i><b>4</b> Fitness for use</a>
<ul>
<li class="chapter" data-level="4.1" data-path="fitness-for-use.html"><a href="fitness-for-use.html#bias"><i class="fa fa-check"></i><b>4.1</b> Bias</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="data-exploration-and-transformation.html"><a href="data-exploration-and-transformation.html"><i class="fa fa-check"></i><b>5</b> Data Exploration and Transformation</a>
<ul>
<li class="chapter" data-level="5.1" data-path="data-exploration-and-transformation.html"><a href="data-exploration-and-transformation.html#wide"><i class="fa fa-check"></i><b>5.1</b> Wide</a></li>
<li class="chapter" data-level="5.2" data-path="data-exploration-and-transformation.html"><a href="data-exploration-and-transformation.html#long"><i class="fa fa-check"></i><b>5.2</b> Long</a></li>
<li class="chapter" data-level="5.3" data-path="data-exploration-and-transformation.html"><a href="data-exploration-and-transformation.html#wide-to-long"><i class="fa fa-check"></i><b>5.3</b> Wide to long</a></li>
<li class="chapter" data-level="5.4" data-path="data-exploration-and-transformation.html"><a href="data-exploration-and-transformation.html#long-to-wide"><i class="fa fa-check"></i><b>5.4</b> Long to Wide</a></li>
<li class="chapter" data-level="5.5" data-path="data-exploration-and-transformation.html"><a href="data-exploration-and-transformation.html#spatial-data"><i class="fa fa-check"></i><b>5.5</b> Spatial data</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="data-exploration-and-transformation.html"><a href="data-exploration-and-transformation.html#spatial-vector-data"><i class="fa fa-check"></i><b>5.5.1</b> Spatial vector data</a></li>
<li class="chapter" data-level="5.5.2" data-path="data-exploration-and-transformation.html"><a href="data-exploration-and-transformation.html#raster"><i class="fa fa-check"></i><b>5.5.2</b> Raster</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="essential-biodiversity-variables.html"><a href="essential-biodiversity-variables.html"><i class="fa fa-check"></i><b>6</b> Essential Biodiversity Variables</a>
<ul>
<li class="chapter" data-level="6.1" data-path="essential-biodiversity-variables.html"><a href="essential-biodiversity-variables.html#sdm"><i class="fa fa-check"></i><b>6.1</b> SDM</a></li>
<li class="chapter" data-level="6.2" data-path="essential-biodiversity-variables.html"><a href="essential-biodiversity-variables.html#diversity"><i class="fa fa-check"></i><b>6.2</b> Diversity</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="essential-biodiversity-variables.html"><a href="essential-biodiversity-variables.html#types-of-analyses---patitioning-alpha-beta-gamma-etc.-diversity"><i class="fa fa-check"></i><b>6.2.1</b> Types of analyses - Patitioning <span class="math inline">\(\alpha\)</span>, <span class="math inline">\(\beta\)</span>, <span class="math inline">\(\gamma\)</span> <em>etc.</em> diversity</a></li>
<li class="chapter" data-level="6.2.2" data-path="essential-biodiversity-variables.html"><a href="essential-biodiversity-variables.html#data-form"><i class="fa fa-check"></i><b>6.2.2</b> Data form</a></li>
<li class="chapter" data-level="6.2.3" data-path="essential-biodiversity-variables.html"><a href="essential-biodiversity-variables.html#classic-diversity-measures"><i class="fa fa-check"></i><b>6.2.3</b> Classic diversity measures</a></li>
<li class="chapter" data-level="6.2.4" data-path="essential-biodiversity-variables.html"><a href="essential-biodiversity-variables.html#alpha-diversity"><i class="fa fa-check"></i><b>6.2.4</b> <span class="math inline">\(\alpha\)</span> diversity</a></li>
<li class="chapter" data-level="6.2.5" data-path="essential-biodiversity-variables.html"><a href="essential-biodiversity-variables.html#beta-diversity-and-dissimilarities"><i class="fa fa-check"></i><b>6.2.5</b> <span class="math inline">\(\beta\)</span> diversity and dissimilarities</a></li>
<li class="chapter" data-level="6.2.6" data-path="essential-biodiversity-variables.html"><a href="essential-biodiversity-variables.html#additional-related-diversities"><i class="fa fa-check"></i><b>6.2.6</b> Additional related diversities</a></li>
<li class="chapter" data-level="6.2.7" data-path="essential-biodiversity-variables.html"><a href="essential-biodiversity-variables.html#numbers-equivalents"><i class="fa fa-check"></i><b>6.2.7</b> Numbers equivalents</a></li>
<li class="chapter" data-level="6.2.8" data-path="essential-biodiversity-variables.html"><a href="essential-biodiversity-variables.html#example-of-analysis-of-diversity"><i class="fa fa-check"></i><b>6.2.8</b> Example of analysis of diversity</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="nils-example-1.html"><a href="nils-example-1.html"><i class="fa fa-check"></i><b>7</b> NILS example 1</a>
<ul>
<li class="chapter" data-level="7.1" data-path="nils-example-1.html"><a href="nils-example-1.html#nils-apis-query-data-via-urls"><i class="fa fa-check"></i><b>7.1</b> NILS APIs: query data via urls</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="nils-example-1.html"><a href="nils-example-1.html#all-data-from-endpoint-klasser"><i class="fa fa-check"></i><b>7.1.1</b> All data from endpoint ‘Klasser’</a></li>
<li class="chapter" data-level="7.1.2" data-path="nils-example-1.html"><a href="nils-example-1.html#extrahera-metadata-från-apiet-habitat"><i class="fa fa-check"></i><b>7.1.2</b> Extrahera metadata från apiet habitat</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="nils-example-1.html"><a href="nils-example-1.html#combine-data-from-different-tables"><i class="fa fa-check"></i><b>7.2</b> Combine data from different tables</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="nils-example-2.html"><a href="nils-example-2.html"><i class="fa fa-check"></i><b>8</b> NILS example 2</a>
<ul>
<li class="chapter" data-level="8.1" data-path="nils-example-2.html"><a href="nils-example-2.html#sdm-1"><i class="fa fa-check"></i><b>8.1</b> SDM</a></li>
<li class="chapter" data-level="8.2" data-path="nils-example-2.html"><a href="nils-example-2.html#diversity-1"><i class="fa fa-check"></i><b>8.2</b> Diversity</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"><img src='images/sbdi-logo-orginal-large.png' class='cover'/> <br><br> A general workflow for analysis of primary biodiversity data</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="nils-example-1" class="section level1 hasAnchor" number="7">
<h1><span class="header-section-number">Chapter 7</span> NILS example 1<a href="nils-example-1.html#nils-example-1" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="nils-example-1.html#cb23-1" tabindex="-1"></a><span class="fu">library</span>(jsonlite)</span>
<span id="cb23-2"><a href="nils-example-1.html#cb23-2" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb23-3"><a href="nils-example-1.html#cb23-3" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb23-4"><a href="nils-example-1.html#cb23-4" tabindex="-1"></a><span class="fu">library</span>(conflicted)</span>
<span id="cb23-5"><a href="nils-example-1.html#cb23-5" tabindex="-1"></a><span class="fu">conflicts_prefer</span>( dplyr<span class="sc">::</span>select, dplyr<span class="sc">::</span>filter)</span>
<span id="cb23-6"><a href="nils-example-1.html#cb23-6" tabindex="-1"></a><span class="co"># library(leaflet)</span></span>
<span id="cb23-7"><a href="nils-example-1.html#cb23-7" tabindex="-1"></a><span class="co"># library(rgdal)</span></span>
<span id="cb23-8"><a href="nils-example-1.html#cb23-8" tabindex="-1"></a><span class="fu">library</span>(glue)</span>
<span id="cb23-9"><a href="nils-example-1.html#cb23-9" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span></code></pre></div>
<div id="nils-apis-query-data-via-urls" class="section level2 hasAnchor" number="7.1">
<h2><span class="header-section-number">7.1</span> NILS APIs: query data via urls<a href="nils-example-1.html#nils-apis-query-data-via-urls" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><a href="https://landskap.slu.se/api/nils/index.html">Swagger description of NILS apis</a></p>
<div id="all-data-from-endpoint-klasser" class="section level3 hasAnchor" number="7.1.1">
<h3><span class="header-section-number">7.1.1</span> All data from endpoint ‘Klasser’<a href="nils-example-1.html#all-data-from-endpoint-klasser" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><a href="https://landskap.slu.se/api/nils/api/" class="uri">https://landskap.slu.se/api/nils/api/</a></p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="nils-example-1.html#cb24-1" tabindex="-1"></a>urlApi <span class="ot">&lt;-</span> <span class="st">&#39;https://landskap.slu.se/api/nils/api/&#39;</span></span>
<span id="cb24-2"><a href="nils-example-1.html#cb24-2" tabindex="-1"></a>endpoint <span class="ot">&lt;-</span> <span class="st">&#39;Klasser&#39;</span></span>
<span id="cb24-3"><a href="nils-example-1.html#cb24-3" tabindex="-1"></a>klasserUrl <span class="ot">&lt;-</span> <span class="fu">url</span>(<span class="fu">glue</span>(<span class="st">&#39;{urlApi}{endpoint}&#39;</span>))</span>
<span id="cb24-4"><a href="nils-example-1.html#cb24-4" tabindex="-1"></a>klasserGet <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(klasserUrl)</span>
<span id="cb24-5"><a href="nils-example-1.html#cb24-5" tabindex="-1"></a>klasser <span class="ot">&lt;-</span> klasserGet<span class="sc">$</span>data</span></code></pre></div>
</div>
<div id="extrahera-metadata-från-apiet-habitat" class="section level3 hasAnchor" number="7.1.2">
<h3><span class="header-section-number">7.1.2</span> Extrahera metadata från apiet habitat<a href="nils-example-1.html#extrahera-metadata-från-apiet-habitat" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>HabitatMetaUrl&lt;-
url(‘<a href="https://landskap.slu.se/api/nils/api/HabitatKlasser/variablesMetadata" class="uri">https://landskap.slu.se/api/nils/api/HabitatKlasser/variablesMetadata</a>’)
habitatMetaGet &lt;- fromJSON(HabitatMetaUrl) habitatMeta &lt;- habitatMetaGet$data</p>
</div>
</div>
<div id="combine-data-from-different-tables" class="section level2 hasAnchor" number="7.2">
<h2><span class="header-section-number">7.2</span> Combine data from different tables<a href="nils-example-1.html#combine-data-from-different-tables" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Example from <span class="citation">(<a href="#ref-hedenås2016">Hedenås, Christensen, and Svensson 2016</a>)</span></p>
<div class="float">
<img src="images/hedenas_%20fig1_map-shows-the-location-of-stratum.png" alt="The map shows the location of stratum 10 (gray), i.e., the Swedish mountain region, and the 145 systematically placed 5 × 5 km sample units (red). The 12 circular sample plots is in the center of the sample unit with a distance of 250 m between the centers of each plot and a distance of 2125 m between the centers of each plot and the edge of the 5 × 5 km2. Each plot consists of two concentric circular plots, and different variables are recorded in these plots. Canopy cover is estimated in the 20-m radius plot, and shrub cover, cover of field vegetation, and cover of the bottom layer are estimated in the 10-m radius plot. The sample plot is divided into subplots if the sample plot contains distinct areas of different types of land use or land cover etc. (Esseen et al. 2007). The figure also shows a list of the field variables used in this study sorted size of the circular sample plots" />
<div class="figcaption">The map shows the location of stratum 10 (gray), i.e., the Swedish mountain region,
and the 145 systematically placed 5 × 5 km sample units (red). The 12 circular sample
plots is in the center of the sample unit with a distance of 250 m between the centers
of each plot and a distance of 2125 m between the centers of each plot and the edge of
the 5 × 5 km2. Each plot consists of two concentric circular plots, and different
variables are recorded in these plots. Canopy cover is estimated in the 20-m radius
plot, and shrub cover, cover of field vegetation, and cover of the bottom layer are
estimated in the 10-m radius plot. The sample plot is divided into subplots if the
sample plot contains distinct areas of different types of land use or land cover etc.
(Esseen et al. 2007). The figure also shows a list of the field variables used in this
study sorted size of the circular sample
plots</div>
</div>
<p>Kombinera data från apiet Klasser med data från apiet Vegetationstackning<br />
Extrahera data från 2020 från apiet Klasser som innehåller alla delytor</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="nils-example-1.html#cb25-1" tabindex="-1"></a>years <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="fu">c</span>(<span class="dv">2003</span><span class="sc">:</span><span class="dv">2012</span>), <span class="at">collapse =</span> <span class="st">&quot;,&quot;</span>)</span>
<span id="cb25-2"><a href="nils-example-1.html#cb25-2" tabindex="-1"></a>klasserUrl <span class="ot">&lt;-</span> <span class="fu">url</span>(<span class="fu">glue</span>(<span class="st">&#39;https://landskap.slu.se/api/nils/api/Klasser?ArIN={years}&#39;</span>)) <span class="co">#?Ar=2020</span></span>
<span id="cb25-3"><a href="nils-example-1.html#cb25-3" tabindex="-1"></a>klasserGet <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(klasserUrl)</span>
<span id="cb25-4"><a href="nils-example-1.html#cb25-4" tabindex="-1"></a>klasser <span class="ot">&lt;-</span> klasserGet<span class="sc">$</span>data</span>
<span id="cb25-5"><a href="nils-example-1.html#cb25-5" tabindex="-1"></a><span class="co"># hist(klasser$ar)</span></span></code></pre></div>
<p>Extrahera data från apiet Vegetationstackning</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="nils-example-1.html#cb26-1" tabindex="-1"></a>vegetationUrl <span class="ot">&lt;-</span> <span class="fu">url</span>(<span class="fu">glue</span>(<span class="st">&#39;https://landskap.slu.se/api/nils/api/Vegetationstackning?ArIN={years}&#39;</span>)) <span class="co">#?Ar=2020</span></span>
<span id="cb26-2"><a href="nils-example-1.html#cb26-2" tabindex="-1"></a>vegetationGet <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(vegetationUrl)</span>
<span id="cb26-3"><a href="nils-example-1.html#cb26-3" tabindex="-1"></a>vegetation <span class="ot">&lt;-</span> vegetationGet<span class="sc">$</span>data <span class="sc">|&gt;</span></span>
<span id="cb26-4"><a href="nils-example-1.html#cb26-4" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(<span class="st">&quot;koordNS&quot;</span>,<span class="st">&quot;koordEW&quot;</span>,<span class="st">&quot;lan&quot;</span>,<span class="st">&quot;kommun&quot;</span>,<span class="st">&quot;bioGeoRegion&quot;</span>,<span class="st">&quot;stratum&quot;</span>)) <span class="co"># Ta bort de kolumner som finns i bägge apierna och som inte behövs för att slå samman tabellerna</span></span>
<span id="cb26-5"><a href="nils-example-1.html#cb26-5" tabindex="-1"></a><span class="co"># names(vegetation)</span></span></code></pre></div>
<p>Kombinera tabellerna till en gemensam tabell</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="nils-example-1.html#cb27-1" tabindex="-1"></a>klassVegetation <span class="ot">&lt;-</span> klasser  <span class="sc">|&gt;</span> </span>
<span id="cb27-2"><a href="nils-example-1.html#cb27-2" tabindex="-1"></a>  <span class="fu">filter</span>(lan <span class="sc">!=</span> <span class="st">&quot;Utlandet&quot;</span>, </span>
<span id="cb27-3"><a href="nils-example-1.html#cb27-3" tabindex="-1"></a>         fjalltyp <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Fjällbjörkskog&quot;</span>, <span class="st">&quot;Område ovan SKOGSgränsen&quot;</span>),</span>
<span id="cb27-4"><a href="nils-example-1.html#cb27-4" tabindex="-1"></a>         ar <span class="sc">&lt;=</span> <span class="dv">2012</span>) <span class="sc">|&gt;</span> </span>
<span id="cb27-5"><a href="nils-example-1.html#cb27-5" tabindex="-1"></a>  <span class="fu">left_join</span>(vegetation, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;ar&quot;</span>,<span class="st">&quot;rutaNummer&quot;</span>, <span class="st">&quot;provytaNummer&quot;</span>,<span class="st">&quot;delytaNummer&quot;</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb27-6"><a href="nils-example-1.html#cb27-6" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">survPer =</span> <span class="fu">ifelse</span>(ar <span class="sc">&lt;</span> <span class="dv">2007</span>, <span class="st">&quot;2003-2007&quot;</span>, <span class="st">&quot;2008-2012&quot;</span>))</span>
<span id="cb27-7"><a href="nils-example-1.html#cb27-7" tabindex="-1"></a></span>
<span id="cb27-8"><a href="nils-example-1.html#cb27-8" tabindex="-1"></a><span class="co"># range(klassVegetation$tradTackningTotal, na.rm = TRUE)</span></span>
<span id="cb27-9"><a href="nils-example-1.html#cb27-9" tabindex="-1"></a><span class="co"># range(klassVegetation$ar, na.rm = TRUE)</span></span>
<span id="cb27-10"><a href="nils-example-1.html#cb27-10" tabindex="-1"></a></span>
<span id="cb27-11"><a href="nils-example-1.html#cb27-11" tabindex="-1"></a>klassVegetationPL <span class="ot">&lt;-</span> klassVegetation <span class="sc">|&gt;</span> </span>
<span id="cb27-12"><a href="nils-example-1.html#cb27-12" tabindex="-1"></a>  <span class="fu">select</span>(fjalltyp, survPer, tradTackningTotal, buskTackningTotal, faltskiktTackningTotal) <span class="sc">|&gt;</span> </span>
<span id="cb27-13"><a href="nils-example-1.html#cb27-13" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">!</span><span class="fu">c</span>(fjalltyp, survPer), <span class="at">names_to =</span> <span class="st">&quot;layer&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;cover&quot;</span>)</span>
<span id="cb27-14"><a href="nils-example-1.html#cb27-14" tabindex="-1"></a></span>
<span id="cb27-15"><a href="nils-example-1.html#cb27-15" tabindex="-1"></a>kvSumm <span class="ot">&lt;-</span> klassVegetationPL <span class="sc">|&gt;</span> </span>
<span id="cb27-16"><a href="nils-example-1.html#cb27-16" tabindex="-1"></a>  <span class="fu">group_by</span>(fjalltyp, survPer, layer) <span class="sc">|&gt;</span> </span>
<span id="cb27-17"><a href="nils-example-1.html#cb27-17" tabindex="-1"></a>  <span class="fu">summarise_at</span>(<span class="at">.vars =</span> <span class="fu">vars</span>(cover), </span>
<span id="cb27-18"><a href="nils-example-1.html#cb27-18" tabindex="-1"></a>               <span class="at">.funs =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="sc">~</span><span class="fu">mean</span>(., <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb27-19"><a href="nils-example-1.html#cb27-19" tabindex="-1"></a>                            <span class="at">sd =</span> <span class="sc">~</span><span class="fu">sd</span>(., <span class="at">na.rm =</span> <span class="cn">TRUE</span>)),</span>
<span id="cb27-20"><a href="nils-example-1.html#cb27-20" tabindex="-1"></a>               <span class="at">.grups =</span> <span class="st">&quot;drop&quot;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb27-21"><a href="nils-example-1.html#cb27-21" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(fjalltyp, survPer, layer), <span class="fu">list</span>(factor)) <span class="sc">|&gt;</span> </span>
<span id="cb27-22"><a href="nils-example-1.html#cb27-22" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span></code></pre></div>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="nils-example-1.html#cb28-1" tabindex="-1"></a><span class="fu">ggplot</span>(kvSumm, <span class="fu">aes</span>(<span class="at">x =</span> layer, <span class="at">y =</span> mean, <span class="at">color =</span> survPer)) <span class="sc">+</span></span>
<span id="cb28-2"><a href="nils-example-1.html#cb28-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.2</span>)) <span class="sc">+</span></span>
<span id="cb28-3"><a href="nils-example-1.html#cb28-3" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> mean <span class="sc">-</span> sd, </span>
<span id="cb28-4"><a href="nils-example-1.html#cb28-4" tabindex="-1"></a>                    <span class="at">ymax =</span> mean <span class="sc">+</span> sd), </span>
<span id="cb28-5"><a href="nils-example-1.html#cb28-5" tabindex="-1"></a>                <span class="at">width =</span> .<span class="dv">1</span>, </span>
<span id="cb28-6"><a href="nils-example-1.html#cb28-6" tabindex="-1"></a>                <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.2</span>)) <span class="sc">+</span> </span>
<span id="cb28-7"><a href="nils-example-1.html#cb28-7" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(fjalltyp), <span class="at">labeller =</span> <span class="fu">as_labeller</span>(<span class="fu">c</span>(<span class="st">&quot;Fjällbjörkskog&quot;</span> <span class="ot">=</span> <span class="st">&quot;Mountain birch forest&quot;</span>, </span>
<span id="cb28-8"><a href="nils-example-1.html#cb28-8" tabindex="-1"></a>                                                      <span class="st">&quot;Område ovan SKOGSgränsen&quot;</span> <span class="ot">=</span> <span class="st">&quot;Alpine&quot;</span>))) <span class="sc">+</span></span>
<span id="cb28-9"><a href="nils-example-1.html#cb28-9" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;Total cover (%)&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Layer&quot;</span>, <span class="at">color =</span> <span class="st">&quot;Sample period&quot;</span>) <span class="sc">+</span></span>
<span id="cb28-10"><a href="nils-example-1.html#cb28-10" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Shrub&quot;</span>, <span class="st">&quot;Field&quot;</span>, <span class="st">&quot;Tree&quot;</span>))</span></code></pre></div>
<p><img src="biodiversity-analysis-tools_files/figure-html/plot-1.png" width="\textwidth" style="display: block; margin: auto;" /></p>

</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-hedenås2016" class="csl-entry">
Hedenås, Henrik, Pernilla Christensen, and Johan Svensson. 2016. <span>“Changes in Vegetation Cover and Composition in the Swedish Mountain Region.”</span> <em>Environmental Monitoring and Assessment</em> 188 (8): 452. <a href="https://doi.org/10.1007/s10661-016-5457-2">https://doi.org/10.1007/s10661-016-5457-2</a>.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="essential-biodiversity-variables.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="nils-example-2.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
